"0","# Define the column names"
"0","column_names <- c(""Albumin_3.5"", ""LMR_2.1"", ""MON_0.8"", ""LY_1.5"", ""ANC_4"", ""ANC_8"", ""NLR_3"", ""NLR_5"", ""PLT_300"", ""Alk_Phos_135"", ""Alk_Phos_200"", ""Age_60"", ""Age_65"", ""Age_70"", ""Prognostic_Score_ALAN_category"")"
"0",""
"0","# Create a separate list of titles for legend labels"
"0","legend_titles <- c(""Albumin "", ""LMR "", ""MON "", ""LY "", ""ANC "", ""ANC "", ""NLR "", ""NLR "", ""PLT "", ""Alk_Phos "", ""Alk_Phos "", ""Age "", ""Age "", ""Age "", ""ALAN_Score:"")"
"0",""
"0",""
"0",""
"0","# Function to create legend labels for each variable"
"0","create_legend_labels <- function(df, column_names, legend_titles) {"
"0","  legend_labels <- list()"
"0","  for (i in seq_along(column_names)) {"
"0","    variable <- column_names[i]"
"0","    title <- legend_titles[i]"
"0","    levels <- levels(df[[variable]])"
"0","    if (length(levels) == 2) {"
"0","      label1 <- paste(title, levels[1], "" (N ="", sum(df[[variable]] == levels[1]), "")"", sep = """")"
"0","      label2 <- paste(title, levels[2], "" (N ="", sum(df[[variable]] == levels[2]), "")"", sep = """")"
"0","      legend_labels[[variable]] <- c(label1, label2)"
"0","    } else if (length(levels) == 3) {"
"0","      label1 <- paste(title, levels[1], "" (N ="", sum(df[[variable]] == levels[1]), "")"", sep = """")"
"0","      label2 <- paste(title, levels[2], "" (N ="", sum(df[[variable]] == levels[2]), "")"", sep = """")"
"0","      label3 <- paste(title, levels[3], "" (N ="", sum(df[[variable]] == levels[3]), "")"", sep = """")"
"0","      legend_labels[[variable]] <- c(label1, label2, label3)"
"0","    } else {"
"0","      labels <- paste(title, levels, "" (N ="", table(df[[variable]]), "")"", sep = """")"
"0","      legend_labels[[variable]] <- labels"
"0","    }"
"0","  }"
"0","  return(legend_labels)"
"0","}"
"0",""
"0",""
"0","# Call the function to create legend labels for each variable"
"0","legend_labels_resistant <- create_legend_labels(resistant_df, column_names, legend_titles)"
"0",""
"0","legend_labels_npt <- create_legend_labels(npt_df, column_names, legend_titles) "
"0",""
"0",""
"0","print(legend_labels_resistant)"
"1","$Albumin_3.5
"
"1","[1]"
"1"," ""Albumin < 3.5 (N =4)""  "
"1"," ""Albumin >= 3.5 (N =15)"""
"1","
"
"1","
"
"1","$LMR_2.1
"
"1","[1]"
"1"," ""LMR < 2.1 (N =3)""  "
"1"," ""LMR >= 2.1 (N =16)"""
"1","
"
"1","
"
"1","$MON_0.8
"
"1","[1]"
"1"," ""MON < 0.8 (N =18)"""
"1"," ""MON >= 0.8 (N =1)"""
"1","
"
"1","
"
"1","$LY_1.5
"
"1","[1]"
"1"," ""LY < 1.5 (N =9)""  "
"1"," ""LY >= 1.5 (N =10)"""
"1","
"
"1","
"
"1","$ANC_4
"
"1","[1]"
"1"," ""ANC < 4 (N =6)""  "
"1"," ""ANC >= 4 (N =13)"""
"1","
"
"1","
"
"1","$ANC_8
"
"1","[1]"
"1"," ""ANC < 8 (N =14)"""
"1"," ""ANC >= 8 (N =5)"""
"1","
"
"1","
"
"1","$NLR_3
"
"1","[1]"
"1"," ""NLR < 3 (N =7)""  "
"1"," ""NLR >= 3 (N =12)"""
"1","
"
"1","
"
"1","$NLR_5
"
"1","[1]"
"1"," ""NLR < 5 (N =12)"""
"1"," ""NLR >= 5 (N =7)"""
"1","
"
"1","
"
"1","$PLT_300
"
"1","[1]"
"1"," ""PLT < 300 (N =17)"""
"1"," ""PLT >= 300 (N =2)"""
"1","
"
"1","
"
"1","$Alk_Phos_135
"
"1","[1]"
"1"," ""Alk_Phos < 135 (N =10)"""
"1"," ""Alk_Phos >= 135 (N =9)"""
"1","
"
"1","
"
"1","$Alk_Phos_200
"
"1","[1]"
"1"," ""Alk_Phos < 200 (N =13)"""
"1"," ""Alk_Phos >= 200 (N =6)"""
"1","
"
"1","
"
"1","$Age_60
"
"1","[1]"
"1"," ""Age < 60 (N =7)""  "
"1"," ""Age >= 60 (N =12)"""
"1","
"
"1","
"
"1","$Age_65
"
"1","[1]"
"1"," ""Age < 65 (N =9)""  "
"1"," ""Age >= 65 (N =10)"""
"1","
"
"1","
"
"1","$Age_70
"
"1","[1]"
"1"," ""Age < 70 (N =14)"""
"1"," ""Age >= 70 (N =5)"""
"1","
"
"1","
"
"1","$Prognostic_Score_ALAN_category
"
"1","[1]"
"1"," ""ALAN_Score:0 (N =8)""  "
"1"," ""ALAN_Score:1-2 (N =8)"""
"1"," ""ALAN_Score:3-4 (N =3)"""
"1","
"
"1","
"
"0","print(legend_labels_npt)"
"1","$Albumin_3.5
"
"1","[1]"
"1"," ""Albumin < 3.5 (N =5)""  "
"1"," ""Albumin >= 3.5 (N =14)"""
"1","
"
"1","
"
"1","$LMR_2.1
"
"1","[1]"
"1"," ""LMR < 2.1 (N =7)""  "
"1"," ""LMR >= 2.1 (N =12)"""
"1","
"
"1","
"
"1","$MON_0.8
"
"1","[1]"
"1"," ""MON < 0.8 (N =10)"""
"1"," ""MON >= 0.8 (N =9)"""
"1","
"
"1","
"
"1","$LY_1.5
"
"1","[1]"
"1"," ""LY < 1.5 (N =5)""  "
"1"," ""LY >= 1.5 (N =14)"""
"1","
"
"1","
"
"1","$ANC_4
"
"1","[1]"
"1"," ""ANC < 4 (N =3)""  "
"1"," ""ANC >= 4 (N =16)"""
"1","
"
"1","
"
"1","$ANC_8
"
"1","[1]"
"1"," ""ANC < 8 (N =13)"""
"1"," ""ANC >= 8 (N =6)"""
"1","
"
"1","
"
"1","$NLR_3
"
"1","[1]"
"1"," ""NLR < 3 (N =10)"""
"1"," ""NLR >= 3 (N =9)"""
"1","
"
"1","
"
"1","$NLR_5
"
"1","[1]"
"1"," ""NLR < 5 (N =13)"""
"1"," ""NLR >= 5 (N =6)"""
"1","
"
"1","
"
"1","$PLT_300
"
"1","[1]"
"1"," ""PLT < 300 (N =11)"""
"1"," ""PLT >= 300 (N =8)"""
"1","
"
"1","
"
"1","$Alk_Phos_135
"
"1","[1]"
"1"," ""Alk_Phos < 135 (N =8)""  "
"1"," ""Alk_Phos >= 135 (N =11)"""
"1","
"
"1","
"
"1","$Alk_Phos_200
"
"1","[1]"
"1"," ""Alk_Phos < 200 (N =11)"""
"1"," ""Alk_Phos >= 200 (N =8)"""
"1","
"
"1","
"
"1","$Age_60
"
"1","[1]"
"1"," ""Age < 60 (N =3)""  "
"1"," ""Age >= 60 (N =16)"""
"1","
"
"1","
"
"1","$Age_65
"
"1","[1]"
"1"," ""Age < 65 (N =5)""  "
"1"," ""Age >= 65 (N =14)"""
"1","
"
"1","
"
"1","$Age_70
"
"1","[1]"
"1"," ""Age < 70 (N =8)""  "
"1"," ""Age >= 70 (N =11)"""
"1","
"
"1","
"
"1","$Prognostic_Score_ALAN_category
"
"1","[1]"
"1"," ""ALAN_Score:0 (N =7)""  "
"1"," ""ALAN_Score:1-2 (N =7)"""
"1"," ""ALAN_Score:3-4 (N =5)"""
"1","
"
"1","
"
