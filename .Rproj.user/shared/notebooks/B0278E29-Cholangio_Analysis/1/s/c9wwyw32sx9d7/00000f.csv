"0","reticulate::repl_python()"
"0","def calculate_categorical_statistics(data, title=""Categorical Statistics""):"
"0","    # Check if data is a DataFrame"
"0","    if not isinstance(data, pd.DataFrame):"
"0","        raise ValueError(""Input 'data' must be a pandas DataFrame."")"
"0","    "
"0","    # Drop the 'ID' column if it exists"
"0","    data = data.drop(columns=['ID'], errors='ignore')"
"0","    "
"0","    # Initialize an empty list to store results"
"0","    result_list = []"
"0","    "
"0","    # Iterate over each non-numeric variable"
"0","    for var in data.select_dtypes(exclude=['number']).columns:"
"0","        # Get value counts for the current variable"
"0","        categories = data[var].value_counts()"
"0","        "
"0","        # Append the results to the list"
"0","        result_list.append(pd.DataFrame({"
"0","            'Variable': [var] * len(categories),"
"0","            'Levels': categories.index,"
"0","            'UniqueValues': len(categories),"
"0","            'Frequencies': categories.values.tolist(),"
"0","            'Proportions': (categories / categories.sum()).map(lambda x: f""{x:.2%}"").tolist()"
"0","        }))"
"0","    "
"0","    # Concatenate the individual DataFrames into one"
"0","    result = pd.concat(result_list, ignore_index=True)"
"0","    "
"0","    # Return result DataFrame"
"0","    return result"
"0",""
