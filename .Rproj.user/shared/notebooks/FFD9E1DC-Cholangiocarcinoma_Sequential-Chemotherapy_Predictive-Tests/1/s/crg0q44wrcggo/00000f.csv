"0","# Define the column names"
"0","column_names <- c(""Albumin_3.5"", ""LMR_2.1"", ""MON_0.8"", ""LY_1.5"", ""ANC_4"", ""ANC_8"", ""NLR_3"", ""NLR_5"", ""PLT_300"", ""Alk_Phos_135"", ""Alk_Phos_200"", ""Age_60"", ""Age_65"", ""Age_70"", ""Cancer_Status"",""Prognostic_Score_ALAN_category"")"
"0",""
"0","# Create a separate list of titles for legend labels"
"0","legend_titles <- c(""Albumin "", ""LMR "", ""MON "", ""LY "", ""ANC "", ""ANC "", ""NLR "", ""NLR "", ""PLT "", ""Alk_Phos "", ""Alk_Phos "", ""Age "", ""Age "", ""Age "","""", ""ALAN_Score:"")"
"0",""
"0",""
"0",""
"0","# Function to create legend labels for each variable"
"0","create_legend_labels <- function(df, column_names, legend_titles) {"
"0","  legend_labels <- list()"
"0","  for (i in seq_along(column_names)) {"
"0","    variable <- column_names[i]"
"0","    title <- legend_titles[i]"
"0","    levels <- levels(df[[variable]])"
"0","    if (length(levels) == 2) {"
"0","      label1 <- paste(title, levels[1], "" (N ="", sum(df[[variable]] == levels[1]), "")"", sep = """")"
"0","      label2 <- paste(title, levels[2], "" (N ="", sum(df[[variable]] == levels[2]), "")"", sep = """")"
"0","      legend_labels[[variable]] <- c(label1, label2)"
"0","    } else if (length(levels) == 3) {"
"0","      label1 <- paste(title, levels[1], "" (N ="", sum(df[[variable]] == levels[1]), "")"", sep = """")"
"0","      label2 <- paste(title, levels[2], "" (N ="", sum(df[[variable]] == levels[2]), "")"", sep = """")"
"0","      label3 <- paste(title, levels[3], "" (N ="", sum(df[[variable]] == levels[3]), "")"", sep = """")"
"0","      legend_labels[[variable]] <- c(label1, label2, label3)"
"0","    } else {"
"0","      labels <- paste(title, levels, "" (N ="", table(df[[variable]]), "")"", sep = """")"
"0","      legend_labels[[variable]] <- labels"
"0","    }"
"0","  }"
"0","  return(legend_labels)"
"0","}"
"0",""
"0",""
"0","# Call the function to create legend labels for each variable"
"0","legend_labels_cca <- create_legend_labels(cca_df, column_names, legend_titles)"
"0",""
"0",""
"0",""
"0",""
"0","print(legend_labels_cca)"
"1","$Albumin_3.5
"
"1","[1]"
"1"," ""Albumin < 3.5 (N =9)""  "
"1","
"
"1","[2]"
"1"," ""Albumin >= 3.5 (N =29)"""
"1","
"
"1","
"
"1","$LMR_2.1
"
"1","[1]"
"1"," ""LMR < 2.1 (N =10)"" "
"1"," ""LMR >= 2.1 (N =28)"""
"1","
"
"1","
"
"1","$MON_0.8
"
"1","[1]"
"1"," ""MON < 0.8 (N =28)"" "
"1"," ""MON >= 0.8 (N =10)"""
"1","
"
"1","
"
"1","$LY_1.5
"
"1","[1]"
"1"," ""LY < 1.5 (N =14)"" "
"1"," ""LY >= 1.5 (N =24)"""
"1","
"
"1","
"
"1","$ANC_4
"
"1","[1]"
"1"," ""ANC < 4 (N =9)""  "
"1"," ""ANC >= 4 (N =29)"""
"1","
"
"1","
"
"1","$ANC_8
"
"1","[1]"
"1"," ""ANC < 8 (N =27)"" "
"1"," ""ANC >= 8 (N =11)"""
"1","
"
"1","
"
"1","$NLR_3
"
"1","[1]"
"1"," ""NLR < 3 (N =17)"" "
"1"," ""NLR >= 3 (N =21)"""
"1","
"
"1","
"
"1","$NLR_5
"
"1","[1]"
"1"," ""NLR < 5 (N =25)"" "
"1"," ""NLR >= 5 (N =13)"""
"1","
"
"1","
"
"1","$PLT_300
"
"1","[1]"
"1"," ""PLT < 300 (N =28)"" "
"1"," ""PLT >= 300 (N =10)"""
"1","
"
"1","
"
"1","$Alk_Phos_135
"
"1","[1]"
"1"," ""Alk_Phos < 135 (N =18)"" "
"1","
"
"1","[2]"
"1"," ""Alk_Phos >= 135 (N =20)"""
"1","
"
"1","
"
"1","$Alk_Phos_200
"
"1","[1]"
"1"," ""Alk_Phos < 200 (N =24)"" "
"1","
"
"1","[2]"
"1"," ""Alk_Phos >= 200 (N =14)"""
"1","
"
"1","
"
"1","$Age_60
"
"1","[1]"
"1"," ""Age < 60 (N =10)"" "
"1"," ""Age >= 60 (N =28)"""
"1","
"
"1","
"
"1","$Age_65
"
"1","[1]"
"1"," ""Age < 65 (N =14)"" "
"1"," ""Age >= 65 (N =24)"""
"1","
"
"1","
"
"1","$Age_70
"
"1","[1]"
"1"," ""Age < 70 (N =22)"" "
"1"," ""Age >= 70 (N =16)"""
"1","
"
"1","
"
"1","$Cancer_Status
"
"1","[1]"
"1"," ""NPT- Cholangiocarcinoma (N =19)""      "
"1","
"
"1","[2]"
"1"," ""Resistant- Cholangiocarcinoma (N =19)"""
"1","
"
"1","
"
"1","$Prognostic_Score_ALAN_category
"
"1","[1]"
"1"," ""ALAN_Score:0 (N =15)""  "
"1","
"
"1","[2]"
"1"," ""ALAN_Score:1-2 (N =15)"""
"1","
"
"1","[3]"
"1"," ""ALAN_Score:3-4 (N =8)"" "
"1","
"
"1","
"
